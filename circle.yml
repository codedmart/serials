machine:
  environment:
    PATH: ${PATH}:/home/ubuntu/flow
    NODE_ENV: test
  services:
    - docker

dependencies:
  pre:
    - sudo apt-get -y -qq update; sudo apt-get -y -qq install wget unzip
    - wget http://flowtype.org/downloads/flow-linux64-latest.zip
    - unzip -o flow-linux64-latest.zip
    - pwd
    - echo $PATH
    - cp -f ./flow/flow /usr/local/bin

  override:
    - docker info
    - docker build -t seanhess/serials .

test:
  override:
    - bin/build; sleep 10
    # run extra tests here
    #- sudo lxc-attach -n "$(docker inspect --format '{{.Id}}' seanhess/serials)" -- bash -c flow
    # I'd like to be able to run flow without

deployment:
  hub:
    branch: master
    commands:
      - docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASS
      - docker push seanhess/serials
      - bin/remote


